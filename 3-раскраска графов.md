# Раскраска графа 

Под раскраской графа почти всегда подразумевается раскраска вершин, те присвоение цветовых меток вершинам так, чтобы любые две вершины с общим ребром имели разные цвета. Графы с петлями не могут быть так раскрашены.

Хроматическое число гррафа - минимальное количество цветов покрасок. 
Полный граф - у которого есть путь из каждой вершины в каждую. Очевидно, его хроматическое число совпадает с количеством вершин.

# Алгоритм полного перебора (наивный)

Пусть дан граф и его раскраска. Чтобы проверить её корректность, нужно обойти все ребра и проверить, есть ли одинаковые цвета на концах. 
Те сложность проверки - линейная O(N). 

Самый простой вариант - генерация всех возможных три-раскрасок и проверка каждой. Сложность - O($3^n$), те число возможных три раскрасов графа

Степенную сложность никак не убрать. 
# Перебор с учетом выбора только из 2 цветов

Пусть есть некоторая вершина - красим её в первый цвет. Для инцидентных выбор из 2 цветов. Сложность - O($2^n$). Здесь используется знание, что инцидентные данной вершины нельзя красить в тот же цвет. 
# Перебор подмножеств размера <= $n/3$

- Если граф уже раскрашен, вершины разделяются на множества - первого, второго и третьего цвета. Очевидно, внутри множеств нет ребер. Если есть n вершин и 3 множества, одно из них имеет мощность <= n/3 вершин

- Пусть заранее известно одно из множеств, то остальные вершины красятся проще - с линейной сложностью O(N).

Нужно найти такое множество. Способов выбрать такое:
$Cn^0+Cn^1+...+Cn^{n/3}<=n*Cn^{n/3}<=1.9^n$ - радиус шара Хэмминга

Сложность алгоритма O($1.9^n$)

# Вероятностный алгоритм (Two-List Coloring). Сведение к задаче выполнимости

Посмотрим все цвета вершин, в которые можно их покрасить. Можно для каждой вершины случайным образом выкинуть один цвет и красить из оставшихся. Тогда каждая вершина может быть покрашена в один из двух цветов. 

Такую задачу можно свести к задаче выполнимости булевых формул (2SAT)

Сведение такое:

Пусть каждый цвет обозначается переменный a1, a2, a3. Нужно покрасить все вершины в какие-то цвета. Те выбрать хотя бы (и только) один из этих цветов. Те для одной вершины верно:
$$(a1∨a2∨a3)\land(\bar a1∨\bar a2)∧(\bar a1∨\bar a3)∨(\bar a2∨\bar a3)$$
1-й дизъюнкт - вершину нужно покрасить
2, 3, 4-е - вершину можно покрасить только в один цвет

Нужно учесть ограничение три-раскраски, те добавить ограничение на неодинаковость цвета инцидентных вершин
$$∧(\bar a1∨\bar b1)∧(\bar a2∨\bar b2)∧(\bar a3∨\bar b3)$$
Вычеркнув неиспользуемые цвета получаем задачу 2SAT, где каждый дизъюнкт содержит не более двух литералов. Эту задачу можно решить за полиномиальное время.

Задачу 3SAT - нельзя решить за линейное время, только перебором. 
(задача 3SAT - определить, существует ли присваивание логических значений переменным, которое делает истинной булеву формулу, являющуюся конъюнкцией, те и, булевых выражений, каждое из которых содержит три переменные)

Задачу 2SAT можно свести к графу, где решение - поиск компонент связности.

Алгоритм поиска компонент сильной свзяности - линейное время O(N). Можно получить наборы из {0,1} из которых получим раскраску или её отсутствие. 

Вероятность не найти раскраску $1/3$. Вероятность, что повезло $\left( \frac{2}{3} \right)^n$

Если найдено решение задачи, граф точно может быть раскрашен, обратное неверно, тк возможно мы вычеркнули нужные цвета для раскраски. Вероятность того, что раскраска выживет после вычеркивания - $(\frac{2}{3})^n$, что очень мало 

Но если прогнать алгоритм $(3/2)^n$ раз, вероятность ошибки 1/e
Если после этого прогнать еще 100 раз, вероятность ошибки $1/e^{100}$

Сложность O($1.5^n$)

# Алгоритм перебора по инцидентным вершинам

Можно перебирать множества инцидентных вершин достаточно эффективно: если одна вершина попала в первое множество, то инцидентные гарантированно там не будут. Алгоритм, основанный на этой идее, дает сложность O($1.45^n$)
# Применение

- Задача планирования: пусть есть список заказов, которые начинаются и заканчиваются в определенное время. Нужно понять, какое минимальное колво ресурсов нужно выделить для решения заказов. Сводится так: пересечение заказов по времени - ребро графа. Хроматическое число графа - ответ.

- Есть карта - отображение информации, предполагает, что между объектами есть границы (политическая карта мира и тп). Задача - определить минимальное число цветов для раскраски графа так, чтобы были видны границы между объектами. Очевидно сводится к раскраске графа.

- Задача оптимального распределения переменных по регистрам. Есть программы на вычислительных машинах, при их запуске происходит отработка аллокации (оптимальное время нахождения в регистре процессора). Пусть каждый цвет - область видимости переменных.